function run042511()
global pdStim screen

% Record for 1000 + 340 + 1500 * 3 + 800 + 1000 secs = 7700
try
    CreateStimuliLogStart();
    
    
    % Define the rectangles
    [screenX, screenY] = Screen('WindowSize', max(Screen('Screens')));
    center1 =[screenX screenY]/2;    
    objRect1 = GetRects(192, center1);

    Wait2Start('debugging',0)
    
    % 1000s
    pdStim = 0;
    pause(.2)
    RF( ...
        'movieDurationSecs', 1000, ...
        'barsWidth',16, ...
        'objContrast',1, ...
        'waitFrames', 1 ...
        );

    % 340s
    pdStim = pdStim+1;
    pause(.2)
    OMS_identifier_LD('presentationLength',20, 'barsWidth', 16);
    
    %%%%%%%%%%%%%%%%%%%%%% Changing contrast every 100s %%%%%%%%%%%%%%%%%%%

    % traditional Gatting Experiment switching contrast every 100s
    % reversing 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.12 1 .24 .06 .03], ...
        'rects', objRect1, ...
        'backMode', [0 0 1 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 100, ...
        'objJitterPeriod', 100, ...
        'presentationLength', 100, ...
        'movieDurationSecs', 500 ...
        );
    
    % traditional Gatting Experiment switching contrast every 100s
    % FEM 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.12 1 .24 .06 .03], ...
        'rects', objRect1, ...
        'backMode', [0 1 0 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 100, ...
        'objJitterPeriod', 100, ...
        'presentationLength', 100, ...
        'movieDurationSecs', 500 ...
        );

    % traditional Gatting Experiment switching contrast every 100s
    % still 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.12 1 .24 .06 .03], ...
        'rects', objRect1, ...
        'backMode', [0 0 0 1], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 100, ...
        'objJitterPeriod', 100, ...
        'presentationLength', 100, ...
        'movieDurationSecs', 500 ...
        );

    %%%%%%%%%%%%%%%%%%%%%% Changing contrast every 10s %%%%%%%%%%%%%%%%%%%

    % traditional Gatting Experiment switching contrast every 10s
    % reversing 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 0 1 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 10, ...
        'objJitterPeriod', 10, ...
        'presentationLength', 10, ...
        'movieDurationSecs', 500 ...
        );
    
    % traditional Gatting Experiment switching contrast every 10s
    % FEM 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 1 0 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 10, ...
        'objJitterPeriod', 10, ...
        'presentationLength', 10, ...
        'movieDurationSecs', 500 ...
        );

    % traditional Gatting Experiment switching contrast every 10s
    % still 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 0 0 1], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 10, ...
        'objJitterPeriod', 10, ...
        'presentationLength', 10, ...
        'movieDurationSecs', 500 ...
        );

    %%%%%%%%%%%%%%%%%%%%%% Changing contrast every 1s %%%%%%%%%%%%%%%%%%%

    % traditional Gatting Experiment switching contrast every 1s
    % reversing 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 0 1 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 1, ...
        'objJitterPeriod', 1, ...
        'presentationLength', 1, ...
        'movieDurationSecs', 500 ...
        );
    
    % traditional Gatting Experiment switching contrast every 1s
    % FEM 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 1 0 0], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 1, ...
        'objJitterPeriod', 1, ...
        'presentationLength', 1, ...
        'movieDurationSecs', 500 ...
        );

    % traditional Gatting Experiment switching contrast every 1s
    % still 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    stimSize = 832;
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 1], ...
        'rects', objRect1, ...
        'backMode', [0 0 0 1], ...
        'backTexture', backTex, ...
        'barsWidth', barsWidth, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 1, ...
        'objJitterPeriod', 1, ...
        'presentationLength', 1, ...
        'movieDurationSecs', 500 ...
        );
    
    
    %%%%%%%%%%%%%%%%    % Sky doesn't dissapear experiment  %%%%%%%%%%%%%%%
    % 800s
    pause(.2)
    pdStim = pdStim+1;
    StableObject( ...
        'backMode', [0 0 1 1], ...
        'barsWidth', 16, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'presentationLength', 100, ...
        'movieDurationSecs', 800 ...
        );

    % short Gating experiment trying BACKGROUND CHECKERS of 4 different
    % sizes
    % 800s
    for i=0:3
        barsWidth = 8*2^i;
        backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
        pdStim = pdStim+1;
        pause(.2)
        UflickerObj( ...
            'objContrast', .03, ...
            'rects', objRect1, ...
            'backMode', [0 0 1 0], ...
            'backTexture', backTex, ...
            'barsWidth', barsWidth, ...
            'stimSize', stimSize, ...
            'backReverseFreq', 1, ...
            'backJitterPeriod', 10, ...
            'objJitterPeriod', 10, ...
            'presentationLength', 10, ...
            'movieDurationSecs', 200 ...
            );
        Screen('Close', backTex{1});
    end
    
    % Probe gating as a function of object size
    % 1000s
    barsWidth = 16;
    backTex = GetCheckersTex(stimSize, barsWidth, screen, 1);
    for i=1:5
        pdStim = pdStim+1;
        pause(.2)
        objRect1 = GetRects(96+32*i, center1);
        UflickerObj( ...
            'objContrast', .03, ...
            'rects', objRect1, ...
            'backMode', [0 0 1 0], ...
            'backTexture', backTex, ...
            'barsWidth', barsWidth, ...
            'stimSize', stimSize, ...
            'backReverseFreq', 1, ...
            'backJitterPeriod', 10, ...
            'objJitterPeriod', 10, ...
            'presentationLength', 10, ...
            'movieDurationSecs', 200 ...
            );
    end
    
    CreateStimuliLogWrite();

catch
    
    FinishExperiment();
    psychrethrow(psychlasterror);
end %try..catch..
end
