function run051311()
global pdStim screen

% Record for 402s twice, then
% Record for 1000 + 100 + 500 + 500 * 2 + 3 hs = 13400
try
    CreateStimuliLogStart();    

    Wait2Start()
    
    % Define the rectangles
    objRect = GetRects(192, screen.center);
    stimSize = 768;
    barsWidth = 64;
    
    pdStim = 0;
    GatingAngle('barsWidth', barsWidth);
    angle = Wait4UserInput([0 45 90 135]);

    pause(.2)
    Wait2Start()
    StableObject('angle', angle, 'backPattern', 0, 'barsWidth', barsWidth);

    pause(.2)
    Wait2Start()
    pdStim = pdStim+1;
    % 1000s
    RF( ...
        'movieDurationSecs', 1000, ...
        'barsWidth',16, ...
        'objContrast',1, ...
        'waitFrames', 1 ...
        );

    % 340s
    pdStim = pdStim+1;
    pause(.2)
    OMS_identifier_LD('presentationLength',20, 'barsWidth', 16);
    
    pdStim = pdStim+1;
    pause(.2)
    Sensitization();

    %%%%%%%%%%%%%%%%%%%%%% Changing contrast every 100s %%%%%%%%%%%%%%%%%%%
    % traditional Gatting Experiment switching contrast every 100s
    % reversing 100um Checkers in background
    % 500
    pdStim = pdStim+1;
    pause(.2)
    UflickerObj( ...
        'objContrast', [.12 .35 .24 .06 .03], ...
        'rects', objRect, ...
        'backMode', [0 0 1 0], ...
        'backPattern', 0, ...
        'barsWidth', barsWidth, ...
        'angle', angle, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 100, ...
        'objJitterPeriod', 100, ...
        'presentationLength', 100, ...
        'movieDurationSecs', 500 ...
        );
    
    %%%%%%%%%%%%%%%%%%%%%% Changing contrast every 1s %%%%%%%%%%%%%%%%%%%
    % traditional Gatting Experiment switching contrast every 1s
    % reversing 100um Checkers in background
    pdStim = pdStim+1;
    pause(.2)
    UflickerObj( ...
        'objContrast', [.03 .06 .12 .24 .35], ...
        'rects', objRect, ...
        'backMode', [0 0 1 0], ...
        'backPattern', 0, ...
        'barsWidth', barsWidth, ...
        'angle', angle, ...
        'stimSize', stimSize, ...
        'backReverseFreq', 1, ...
        'backJitterPeriod', 1, ...
        'objJitterPeriod', 1, ...
        'presentationLength', 1, ...
        'movieDurationSecs', 500 ...
        );
    
    %%%%%%%%%%%%%%%%%%%%%%% information experiment %%%%%%%%%%%%%%%%%%%%%%%%
    pause(.2)
    pdStim = pdStim+1;
    ContrastPhaseInformation(...
        'backContrast', 1, ...
        'objContrasts', [.03 .06 .12 .24 .35], ...
        'objCheckerSize', 192, ...
        'backPattern', 0, ...
        'barsWidth', barsWidth, ...
        'angle', angle, ...
        'objFreq', 10, ...
        'presentationLength', 17, ...
        'movieDurationSecs', 3600*3, ...
        'objRect', objRect ...
        );
    
    CreateStimuliLogWrite();

catch 
    FinishExperiment();
    psychrethrow(psychlasterror);
end %try..catch..
end
